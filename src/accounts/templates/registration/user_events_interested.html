{% extends 'base.html' %}
{% load static %}

{% block title %}
  <title>Les évènements intéréssés</title>
{% endblock %}

{% block content %}
  <div class="container container-section">
    <div class="row row-padding">
      <h1 class="text-center">La liste des évènements intéréssés</h1>
    </div>
  </div>
  <div class="container container-section">
    {% if user.interested %}
    <div class="row row-padding row-cols-1 row-cols-md-4 g-4">
      {% for event in user.interested.all %}
        <div class="col">
          <div class="card h-100">
            {% if event.thumbnail %}
              <a href="{% url 'events:event' slug=event.slug %}"><img src="{{ event.thumbnail.url }}" class="card-img-top img-fluid" alt="{{ event.title }}" /></a>
            {% else %}
              <a href="{% url 'events:event' slug=event.slug %}"><div class="card-img-top img-fluid"></div></a>
            {% endif %}
            <div class="card-body">
              <div class="row">
                <div class="col">
                  <div class="headline">
                    <a href="{% url 'events:event' slug=event.slug %}"><h5 class="card-title">{{ event.title|title }}</h5></a>
                    {% if event.is_sponsored %}
                      <p class="fw-lighter fst-italic">- Sponsorisé</p>
                    {% endif %}
                  </div>
                </div>
                <div class="col-2">
                  <form action="{% url 'events:interested' slug=event.slug %}" method="POST">
                    {% csrf_token %}

                    {% if request.user not in event.interested.all %}
                      <button type="submit" value="{{ event.slug }}" class="btn btn"><i class="bi bi-bookmark-heart"></i></button>
                    {% else %}
                      <button type="submit" value="{{ event.slug }}" class="btn btn"><i class="bi bi-bookmark-heart-fill"></i></button>
                    {% endif %}
                  </form>
                </div>
              </div>
              <div class="row">
                <p class="card-text">{{ event.location }}</p>
                <p class="card-text">
                  <small class="text-body-secondary">
                    {{ event.starts }} | {% if event.price %}
                      {{ event.price }}€
                    {% else %}
                      GRATUIT
                    {% endif %}
                  </small>
                </p>
              </div>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>

    {% else %}
      <div class="col">
        <div class="row">
          <h2>Pas d'évènement suivi pour le moment !</h2>
        </div>
      </div>
    {% endif %}

  </div>
{% endblock %}
